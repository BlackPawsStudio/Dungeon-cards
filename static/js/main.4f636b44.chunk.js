(this["webpackJsonpdungeon-cards"]=this["webpackJsonpdungeon-cards"]||[]).push([[0],{16:function(e,t,r){},17:function(e,t,r){},24:function(e,t,r){},27:function(e,t,r){"use strict";r.r(t);var n=r(0),a=r.n(n),c=r(5),i=(r(16),r(17),r(3)),o=r(6),s=function(e,t,r){var n=Object(i.a)(t,2),a=n[0],c=n[1],o=8*Math.random();return{id:e,x:a,y:c,type:o>r?"foe":"heal",hp:o>r?Math.trunc(3*Math.random()+1):Math.trunc(4*Math.random()+5)}},u={id:4,x:1,y:1,type:"hero",hp:10},d=Object(o.b)({name:"cards",initialState:{isAIEnabled:!1,cards:Array(3).fill([]),scoreCount:0,hero:u,isGameOver:!0},reducers:{initFill:function(e){var t=-1;e.isAIEnabled=!1,e.scoreCount=0,e.hero=u;for(var r=0;r<3;r++)for(var n=0;n<3;n++)e.cards[r][n]=s(++t,[r,n],3);e.cards[e.hero.x][e.hero.y]=e.hero,e.isGameOver=!1},move:function(e,t){var r=Object(i.a)(t.payload,2),n=r[0],a=r[1],c=e.cards[n][a];if(function(e,t){var r=Object(i.a)(e,2),n=r[0],a=r[1],c=Object(i.a)(t,2),o=c[0],s=c[1];return o===n&&s===a?(alert("It's you dum!"),!1):(o+1===n||o-1===n)&&s===a||(s+1===a||s-1===a)&&o===n}([n,a],[e.hero.x,e.hero.y])){var o=function(e){return("foe"===e.type?-1:1)*e.hp}(c);e.hero.hp=Math.min(e.hero.hp+o,10),e.hero.hp<=0&&(alert("Game over! Your score ".concat(e.scoreCount)),e.isAIEnabled=!1,e.isGameOver=!0),o<0&&e.hero.hp>0&&e.scoreCount++,e.cards=function(e,t,r){var n=e.concat(),a=t.x===r.x?"x":"y",c="x"===a?"y":"x",i=n.flat().filter((function(e){return e[a]===t[a]})),o=i[r[c]<t[c]?i.length-1:0];n[r.x][r.y].type=t.type,n[r.x][r.y].hp=t.hp,"hero"!==o.type&&(n[t.x][t.y].type=o.type,n[t.x][t.y].hp=o.hp);var u=s(o.id,[o.x,o.y],3);return o.type=u.type,o.hp=u.hp,n}(e.cards,e.hero,c),e.hero=e.cards.flat().find((function(e){return"hero"===e.type}))}},enableAI:function(e){e.isAIEnabled=!0}}}),l=d.reducer,h=d.actions,f=h.initFill,b=h.move,p=h.enableAI,j=r(4),v=function(){return Object(j.b)()},m=j.c,x=(r(24),r.p+"static/media/hero.5b2609bc.svg"),O=r.p+"static/media/hp0.013dd3c2.svg",y=r.p+"static/media/hp1.17d3ee61.svg",g={hero:{0:x},heal:{5:O,6:O,7:y,8:y},foe:{1:r.p+"static/media/foe1.c477179c.svg",2:r.p+"static/media/foe2.91be41a9.svg",3:r.p+"static/media/foe3.b4c66bde.svg"}},E=r(1);function I(){var e=m((function(e){var t=e.cardSlice;return{cards:t.cards.flat(),isGameOver:t.isGameOver,isAIEnabled:t.isAIEnabled}})),t=e.cards,r=e.isGameOver,a=e.isAIEnabled,c=v();return Object(n.useEffect)((function(){r&&c(f())}),[r]),Object(E.jsx)("div",{className:"cards-place",children:t.map((function(e){return Object(E.jsx)(A,{desc:e,isEnabled:a},e.id)}))})}function A(e){var t=v(),r=e.desc,n=g[r.type]["hero"===r.type?0:r.hp];return Object(E.jsxs)("button",{className:"card card-".concat(r.type),onClick:function(){t(b([r.x,r.y]))},disabled:e.isEnabled,children:[Object(E.jsx)("img",{src:n,alt:r.type,className:"card-image"}),Object(E.jsxs)("p",{className:"card-text",children:[" ",r.hp,"hero"===r.type?"/10":""]})]})}var C=r(9),G=r.n(C),S=r(11),k=function(e,t){var r=Object(i.a)(e,2),n=r[0],a=r[1];return t.filter((function(e){return e.x===n&&e.y+1===a||e.x===n&&e.y-1===a||e.x+1===n&&e.y===a||e.x-1===n&&e.y===a}))},F=function(e,t){var r=e.filter((function(e){return e.type===t}));return r?(r.sort((function(e,t){return e.hp<t.hp?-1:1})),r[0]):null},M=function(e,t,r,n){var a=e.map((function(e){return function(e,t){var r=k([e.x,e.y],t.flat()).filter((function(e){return"heal"===e.type})).length;return{id:e.id,amount:r}}(e,t)}));if(a.sort((function(e,t){return e.amount>t.amount?-1:1})),0===a[0].amount)return r;var c=e.find((function(e){return e.id===a[0].id}));return c.hp<n.hp?c:r},N=function(){var e=m((function(e){var t=e.cardSlice;return{cards:t.cards,isGameOver:t.isGameOver,hero:t.hero,isAIEnabled:t.isAIEnabled}})),t=e.cards,r=e.isGameOver,a=e.hero,c=e.isAIEnabled,i=v();Object(n.useEffect)((function(){!r&&c&&o()}),[t]);var o=function(){setTimeout((function(){var e=function(e,t){var r=k([e.x,e.y],t.flat()),n=F(r,"heal"),a=function(e,t,r){return t?e&&r.hp>2*e.hp?e:t:e}(F(r,"foe"),n,e);return M(r,t,a,e)}(a,t);e?i(b([e.x,e.y])):console.log("pizda")}),1e3)},s=function(){var e=Object(S.a)(G.a.mark((function e(){return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i(p()),o();case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(E.jsx)(E.Fragment,{children:Object(E.jsx)("button",{className:"ai-button",onClick:function(){s()},disabled:c,children:"Enable auto play"})})};function w(){var e=m((function(e){return e.cardSlice.scoreCount}));return Object(E.jsxs)("div",{className:"stats",children:[Object(E.jsxs)("h3",{children:["Score: ",e]}),Object(E.jsx)(N,{})]})}var T=r(2),D=Object(T.b)({cardSlice:l}),B=Object(o.a)({reducer:D});var J=function(){return Object(E.jsx)(j.a,{store:B,children:Object(E.jsxs)("div",{className:"root",children:[Object(E.jsx)("header",{children:Object(E.jsx)("h1",{children:"Dungeon Cards AI"})}),Object(E.jsxs)("main",{children:[Object(E.jsx)(w,{}),Object(E.jsx)(I,{})]}),Object(E.jsxs)("footer",{children:[Object(E.jsx)("a",{target:"blank",href:"https://github.com/blackpawsstudio",children:"GitHub"}),Object(E.jsx)("a",{target:"blank",href:"https://play.google.com/store/apps/details?id=com.The717pixels.DungeonCards&hl=ru&gl=US",children:"Original game"})]})]})})},L=function(e){e&&e instanceof Function&&r.e(3).then(r.bind(null,28)).then((function(t){var r=t.getCLS,n=t.getFID,a=t.getFCP,c=t.getLCP,i=t.getTTFB;r(e),n(e),a(e),c(e),i(e)}))};Object(c.render)(Object(E.jsx)(a.a.StrictMode,{children:Object(E.jsx)(J,{})}),document.getElementById("root")),L()}},[[27,1,2]]]);
//# sourceMappingURL=main.4f636b44.chunk.js.map